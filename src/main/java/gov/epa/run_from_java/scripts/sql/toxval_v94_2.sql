
select *
from `20230419_toxval_v94`.genetox_details gd
left join `20230419_toxval_v94`.chemical c on gd.dtxsid=c.dtxsid;



select *
from `20230419_toxval_v94`.genetox_details gd
left join `20230419_toxval_v94`.chemical c on gd.dtxsid=c.dtxsid
where gd.dtxsid in
      ('DTXSID0020600', 'DTXSID0020604', 'DTXSID2020470', 'DTXSID2021286', 'DTXSID4020666', 'DTXSID6020569',
       'DTXSID6020561', 'DTXSID5021207', 'DTXSID1024126', 'DTXSID0025361', 'DTXSID9020665', 'DTXSID9020453',
       'DTXSID8021145', 'DTXSID6023573', 'DTXSID9039232', 'DTXSID5025360', 'DTXSID4026262', 'DTXSID0041307',
       'DTXSID4051871', 'DTXSID00700013', 'DTXSID501014417', 'DTXSID501020204', 'DTXSID801020203', 'DTXSID801173325',
       'DTXSID601029330', 'DTXSID60905244', 'DTXSID40904710', 'DTXSID901034223', 'DTXSID0037497', 'DTXSID1020649',
       'DTXSID3020382', 'DTXSID3021067', 'DTXSID9036779', 'DTXSID9020455', 'DTXSID5025237', 'DTXSID6024880',
       'DTXSID2031374', 'DTXSID9044166', 'DTXSID70183617', 'DTXSID00320093', 'DTXSID00862928', 'DTXSID201320388',
       'DTXSID20950492', 'DTXSID70951237', 'DTXSID90865529', 'DTXSID50953491', 'DTXSID70955659', 'DTXSID30996346',
       'DTXSID00957808', 'DTXSID60957809', 'DTXSID70958640', 'DTXSID00960397', 'DTXSID30919378', 'DTXSID90920162',
       'DTXSID30921739', 'DTXSID40879070', 'DTXSID90878831', 'DTXSID00879995', 'DTXSID40971740', 'DTXSID40931344',
       'DTXSID90975930', 'DTXSID20891851', 'DTXSID80891791', 'DTXSID00891839', 'DTXSID60891810', 'DTXSID60891850',
       'DTXSID50933718', 'DTXSID10893263', 'DTXSID401349483', 'DTXSID301315142', 'DTXSID60894866', 'DTXSID40897234',
       'DTXSID00983581', 'DTXSID40941443', 'DTXSID30985351', 'DTXSID60941768', 'DTXSID20984272', 'DTXSID501031653',
       'DTXSID4025246', 'DTXSID9025245', 'DTXSID9025249', 'DTXSID6052455', 'DTXSID0052700', 'DTXSID90947511',
       'DTXSID00947865', 'DTXSID001274561', 'DTXSID50952666', 'DTXSID60865935', 'DTXSID10913551', 'DTXSID30914040',
       'DTXSID60916370', 'DTXSID10916325', 'DTXSID00916238', 'DTXSID90958288', 'DTXSID10962387', 'DTXSID90963711',
       'DTXSID10964407', 'DTXSID50880874', 'DTXSID101006339', 'DTXSID40885191', 'DTXSID80885059', 'DTXSID10885204',
       'DTXSID90886451', 'DTXSID30887447', 'DTXSID001014955', 'DTXSID80888181', 'DTXSID10977355', 'DTXSID701312471',
       'DTXSID60944739', 'DTXSID1040372', 'DTXSID1024702', 'DTXSID2040579', 'DTXSID4024692', 'DTXSID6024624',
       'DTXSID2027466', 'DTXSID9023706', 'DTXSID7024667', 'DTXSID7024875', 'DTXSID6025480', 'DTXSID8024862',
       'DTXSID9024691', 'DTXSID8025707', 'DTXSID8027585', 'DTXSID0042248', 'DTXSID7044762', 'DTXSID4044872',
       'DTXSID301318560', 'DTXSID60864660', 'DTXSID601140358', 'DTXSID00866406', 'DTXSID60954813', 'DTXSID90869800',
       'DTXSID40470147', 'DTXSID201335177', 'DTXSID80884906', 'DTXSID60888669', 'DTXSID60972996', 'DTXSID10972789',
       'DTXSID701018639', 'DTXSID50942603', 'DTXSID60906099', 'DTXSID4035548', 'DTXSID4020452', 'DTXSID4023389',
       'DTXSID1057957', 'DTXSID7040736', 'DTXSID9025243', 'DTXSID5027489', 'DTXSID9025613', 'DTXSID8029286');


select t.source, count(distinct(t.dtxsid)) from toxval t
group by t.source;

select t.source, count(distinct(t.dtxsid)) from toxval t
where study_type='acute' and toxval_units='mg/kg' and toxval_type='LD50'
and species_original='rat' and exposure_route='oral'
group by t.source;


select count(distinct(t.dtxsid)) from toxval t
where study_type='acute' and toxval_units='mg/kg' and toxval_type='LD50'
and species_original='rat' and exposure_route='oral' and t.source='ECHA IUCLID'
group by t.source;



select count(distinct (dtxsid)) from toxval t
where
      study_type='acute' and toxval_units='mg/kg' and toxval_type='LD50'
      and species_original='rat' and exposure_route='oral'
--       and source='ECHA IUCLID'
;

select t.source, count(distinct(t.dtxsid)) from toxval t
where study_type='acute' and toxval_units='mg/kg' and toxval_type='LD50'
and species_original='rat' and exposure_route='oral'
group by t.source;
